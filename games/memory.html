<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ğŸ§© ×–×™×›×¨×•×Ÿ ×¤×•×¨×™×</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ§©</text></svg>">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Frank+Ruhl+Libre:wght@400;700;900&family=Heebo:wght@300;400;700;900&display=swap');
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Heebo', sans-serif;
      background: linear-gradient(135deg, #1e0a3c, #4c1d95);
      color: #fff;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
    }
    .back-link {
      position: fixed;
      top: 15px;
      right: 15px;
      color: rgba(255,255,255,0.5);
      text-decoration: none;
      font-size: 0.9rem;
      z-index: 100;
      background: rgba(0,0,0,0.3);
      padding: 6px 14px;
      border-radius: 8px;
    }
    .back-link:hover { color: #fbbf24; }

    h1 {
      font-family: 'Frank Ruhl Libre', serif;
      font-size: clamp(1.8rem, 5vw, 2.5rem);
      color: #fbbf24;
      text-align: center;
      margin: 10px 0;
    }
    .stats {
      display: flex;
      gap: 20px;
      margin: 10px 0 20px;
      font-size: 1.1rem;
    }
    .stat {
      background: rgba(255,255,255,0.1);
      padding: 6px 16px;
      border-radius: 10px;
    }
    .stat span { color: #fbbf24; font-weight: 700; }

    .difficulty-select {
      display: flex;
      gap: 10px;
      margin-bottom: 15px;
    }
    .diff-btn {
      font-family: 'Heebo', sans-serif;
      padding: 8px 20px;
      border: 2px solid rgba(251,191,36,0.3);
      background: rgba(251,191,36,0.1);
      color: #fbbf24;
      border-radius: 10px;
      cursor: pointer;
      font-size: 0.9rem;
      transition: all 0.3s;
    }
    .diff-btn:hover, .diff-btn.active {
      background: rgba(251,191,36,0.3);
      border-color: #fbbf24;
    }

    .board {
      display: grid;
      gap: 10px;
      max-width: 600px;
      width: 100%;
      margin: 0 auto;
    }
    .board.size-4 { grid-template-columns: repeat(4, 1fr); }
    .board.size-5 { grid-template-columns: repeat(5, 1fr); }
    .board.size-6 { grid-template-columns: repeat(4, 1fr); }

    .card {
      aspect-ratio: 1;
      border-radius: 14px;
      cursor: pointer;
      position: relative;
      perspective: 800px;
      transition: transform 0.15s;
    }
    .card:hover { transform: scale(1.05); }
    .card:active { transform: scale(0.95); }

    .card-inner {
      width: 100%;
      height: 100%;
      position: relative;
      transform-style: preserve-3d;
      transition: transform 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    }
    .card.flipped .card-inner { transform: rotateY(180deg); }
    .card.matched .card-inner { transform: rotateY(180deg); }
    .card.matched { animation: matchPop 0.5s ease-out; }
    @keyframes matchPop {
      0% { transform: scale(1); }
      50% { transform: scale(1.15); }
      100% { transform: scale(1); }
    }

    .card-face {
      position: absolute;
      width: 100%;
      height: 100%;
      backface-visibility: hidden;
      border-radius: 14px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .card-front {
      background: linear-gradient(135deg, #7c3aed, #a78bfa);
      border: 2px solid rgba(255,255,255,0.2);
      font-size: 2rem;
      color: rgba(255,255,255,0.3);
    }
    .card-front::after {
      content: 'ğŸ­';
      font-size: clamp(1.5rem, 5vw, 2.5rem);
    }
    .card-back {
      transform: rotateY(180deg);
      background: linear-gradient(135deg, #1e0a3c, #2d1066);
      border: 2px solid rgba(251,191,36,0.4);
      font-size: clamp(2rem, 7vw, 3.5rem);
    }
    .card.matched .card-back {
      border-color: #22c55e;
      background: linear-gradient(135deg, rgba(34,197,94,0.2), rgba(34,197,94,0.1));
    }

    .win-screen {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.85);
      display: none;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      z-index: 200;
      text-align: center;
      padding: 20px;
    }
    .win-screen.active { display: flex; }
    .win-emoji { font-size: 5rem; animation: bounce 1s ease-in-out infinite; }
    @keyframes bounce { 0%,100% { transform: translateY(0); } 50% { transform: translateY(-20px); } }
    .win-title {
      font-family: 'Frank Ruhl Libre', serif;
      font-size: 2.5rem;
      color: #fbbf24;
      margin: 15px 0;
    }
    .win-stats {
      font-size: 1.2rem;
      color: rgba(255,255,255,0.7);
      margin-bottom: 20px;
      line-height: 2;
    }
    .win-btn {
      font-family: 'Heebo', sans-serif;
      padding: 12px 35px;
      font-size: 1.1rem;
      border: 2px solid #fbbf24;
      background: rgba(251,191,36,0.2);
      color: #fbbf24;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s;
      margin: 5px;
    }
    .win-btn:hover { background: rgba(251,191,36,0.4); }
    .win-btn.primary { background: #fbbf24; color: #1e0a3c; }
  </style>
</head>
<body>

<a href="../index.html" class="back-link">â†’ ×—×–×¨×” ×œ×ª×¤×¨×™×˜</a>

<h1>ğŸ§© ×–×™×›×¨×•×Ÿ ×¤×•×¨×™×</h1>

<div class="difficulty-select">
  <button class="diff-btn active" onclick="startGame(4)">×§×œ (8 ×–×•×’×•×ª)</button>
  <button class="diff-btn" onclick="startGame(5)">×‘×™× ×•× ×™ (10 ×–×•×’×•×ª)</button>
  <button class="diff-btn" onclick="startGame(6)">×§×©×” (12 ×–×•×’×•×ª)</button>
</div>

<div class="stats">
  <div class="stat">××”×œ×›×™×: <span id="moves">0</span></div>
  <div class="stat">×–×•×’×•×ª: <span id="pairs">0</span>/<span id="totalPairs">8</span></div>
  <div class="stat">â±ï¸ <span id="timer">0:00</span></div>
</div>

<div class="board size-4" id="board"></div>

<div class="win-screen" id="winScreen">
  <div class="win-emoji">ğŸ†</div>
  <h2 class="win-title">×›×œ ×”×›×‘×•×“!</h2>
  <div class="win-stats" id="winStats"></div>
  <div>
    <button class="win-btn primary" onclick="startGame(currentSize)">×©×—×§×• ×©×•×‘!</button>
    <button class="win-btn" onclick="location.href='../index.html'">×—×–×¨×” ×œ×ª×¤×¨×™×˜</button>
  </div>
</div>

<script>
const CHARACTERS = [
  { emoji: 'ğŸ‘¸', name: '××¡×ª×¨' },
  { emoji: 'ğŸ§”', name: '××¨×“×›×™' },
  { emoji: 'ğŸ‘‘', name: '××—×©×•×¨×•×©' },
  { emoji: 'ğŸ˜ˆ', name: '×”××Ÿ' },
  { emoji: 'ğŸ‘°', name: '×•×©×ª×™' },
  { emoji: 'ğŸ—¡ï¸', name: '×—×¨×‘×•× ×' },
  { emoji: 'ğŸ“œ', name: '×”××’×™×œ×”' },
  { emoji: 'ğŸ´', name: '×”×¡×•×¡' },
  { emoji: 'ğŸ‘¿', name: '×–×¨×©' },
  { emoji: 'ğŸ°', name: '×©×•×©×Ÿ' },
  { emoji: 'ğŸ­', name: '×ª×—×¤×•×©×ª' },
  { emoji: 'ğŸª', name: '××•×–×Ÿ ×”××Ÿ' },
  { emoji: 'ğŸ“¢', name: '×¨×¢×©×Ÿ' },
  { emoji: 'ğŸ', name: '××©×œ×•×— ×× ×•×ª' },
  { emoji: 'ğŸ·', name: '×™×™×Ÿ' },
  { emoji: 'ğŸŒ³', name: '×”×¢×¥' },
];

let currentSize = 4;
let cards = [];
let flipped = [];
let matched = 0;
let moves = 0;
let totalPairsCount = 8;
let timer = null;
let seconds = 0;
let locked = false;

function startGame(size) {
  currentSize = size;
  const pairsMap = { 4: 8, 5: 10, 6: 12 };
  totalPairsCount = pairsMap[size];
  matched = 0;
  moves = 0;
  seconds = 0;
  flipped = [];
  locked = false;

  document.getElementById('moves').textContent = '0';
  document.getElementById('pairs').textContent = '0';
  document.getElementById('totalPairs').textContent = totalPairsCount;
  document.getElementById('timer').textContent = '0:00';
  document.getElementById('winScreen').classList.remove('active');

  // Update difficulty buttons
  document.querySelectorAll('.diff-btn').forEach((btn, i) => {
    btn.classList.toggle('active', [4,5,6][i] === size);
  });

  // Update board class
  const board = document.getElementById('board');
  board.className = `board size-${size}`;

  // Pick characters and create pairs
  const selected = CHARACTERS.slice(0, totalPairsCount);
  const deck = [...selected, ...selected];
  shuffle(deck);
  cards = deck;

  // Render
  board.innerHTML = '';
  deck.forEach((char, i) => {
    const card = document.createElement('div');
    card.className = 'card';
    card.dataset.index = i;
    card.innerHTML = `
      <div class="card-inner">
        <div class="card-face card-front"></div>
        <div class="card-face card-back">${char.emoji}</div>
      </div>
    `;
    card.addEventListener('click', () => flipCard(card, i));
    board.appendChild(card);
  });

  // Start timer
  if (timer) clearInterval(timer);
  timer = setInterval(() => {
    seconds++;
    const m = Math.floor(seconds / 60);
    const s = seconds % 60;
    document.getElementById('timer').textContent = `${m}:${s.toString().padStart(2, '0')}`;
  }, 1000);
}

function flipCard(cardEl, index) {
  if (locked) return;
  if (cardEl.classList.contains('flipped') || cardEl.classList.contains('matched')) return;
  if (flipped.length >= 2) return;

  cardEl.classList.add('flipped');
  flipped.push({ el: cardEl, index });

  if (flipped.length === 2) {
    moves++;
    document.getElementById('moves').textContent = moves;
    locked = true;

    const [a, b] = flipped;
    if (cards[a.index].emoji === cards[b.index].emoji) {
      // Match!
      setTimeout(() => {
        a.el.classList.add('matched');
        b.el.classList.add('matched');
        matched++;
        document.getElementById('pairs').textContent = matched;
        flipped = [];
        locked = false;

        if (matched === totalPairsCount) {
          clearInterval(timer);
          showWin();
        }
      }, 400);
    } else {
      // No match
      setTimeout(() => {
        a.el.classList.remove('flipped');
        b.el.classList.remove('flipped');
        flipped = [];
        locked = false;
      }, 800);
    }
  }
}

function showWin() {
  const m = Math.floor(seconds / 60);
  const s = seconds % 60;
  const timeStr = `${m}:${s.toString().padStart(2, '0')}`;

  let stars = 'â­â­â­';
  if (moves > totalPairsCount * 3) stars = 'â­â­';
  if (moves > totalPairsCount * 5) stars = 'â­';

  document.getElementById('winStats').innerHTML = `
    ${stars}<br>
    â±ï¸ ×–××Ÿ: ${timeStr}<br>
    ğŸ¯ ××”×œ×›×™×: ${moves}<br>
    ğŸ§© ${totalPairsCount} ×–×•×’×•×ª
  `;
  document.getElementById('winScreen').classList.add('active');
}

function shuffle(arr) {
  for (let i = arr.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [arr[i], arr[j]] = [arr[j], arr[i]];
  }
}

// Start default game
startGame(4);
</script>

</body>
</html>
