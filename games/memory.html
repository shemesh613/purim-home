<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ğŸ§© ×–×™×›×¨×•×Ÿ ×¤×•×¨×™×</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ§©</text></svg>">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Frank+Ruhl+Libre:wght@400;700;900&family=Heebo:wght@300;400;700;900&display=swap');
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Heebo', sans-serif;
      background: linear-gradient(180deg, #fef9ef, #fdf4ff);
      color: #1e1b4b;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 15px;
    }
    .back-link {
      position: fixed; top: 12px; right: 12px;
      color: #7c3aed; text-decoration: none;
      font-size: 0.85rem; z-index: 100;
      background: #fff; padding: 5px 12px;
      border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    h1 {
      font-family: 'Frank Ruhl Libre', serif;
      font-size: clamp(1.6rem, 5vw, 2.2rem);
      color: #7c3aed;
      text-align: center;
      margin: 8px 0;
    }
    .stats {
      display: flex; gap: 12px;
      margin: 8px 0 12px;
      font-size: 0.95rem;
    }
    .stat {
      background: #fff;
      padding: 5px 14px;
      border-radius: 10px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.06);
    }
    .stat span { color: #7c3aed; font-weight: 700; }
    .difficulty-select {
      display: flex; gap: 8px;
      margin-bottom: 12px;
    }
    .diff-btn {
      font-family: 'Heebo', sans-serif;
      padding: 6px 16px;
      border: 2px solid rgba(124,58,237,0.2);
      background: #fff;
      color: #7c3aed;
      border-radius: 10px;
      cursor: pointer;
      font-size: 0.85rem;
      transition: all 0.3s;
    }
    .diff-btn:hover, .diff-btn.active {
      background: #7c3aed; color: #fff; border-color: #7c3aed;
    }
    .board {
      display: grid;
      gap: 8px;
      max-width: 500px;
      width: 100%;
    }
    .board.size-4 { grid-template-columns: repeat(4, 1fr); }
    .board.size-5 { grid-template-columns: repeat(5, 1fr); }
    .board.size-6 { grid-template-columns: repeat(4, 1fr); }
    .card {
      aspect-ratio: 0.85;
      border-radius: 12px;
      cursor: pointer;
      perspective: 800px;
      transition: transform 0.15s;
    }
    .card:hover { transform: scale(1.04); }
    .card-inner {
      width: 100%; height: 100%;
      position: relative;
      transform-style: preserve-3d;
      transition: transform 0.45s cubic-bezier(0.4, 0, 0.2, 1);
    }
    .card.flipped .card-inner, .card.matched .card-inner { transform: rotateY(180deg); }
    .card.matched { animation: matchPop 0.5s ease-out; }
    @keyframes matchPop { 0% { transform: scale(1); } 50% { transform: scale(1.12); } 100% { transform: scale(1); } }
    .card-face {
      position: absolute;
      width: 100%; height: 100%;
      backface-visibility: hidden;
      border-radius: 12px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }
    .card-front {
      background: linear-gradient(135deg, #c084fc, #a78bfa);
      border: 2px solid rgba(255,255,255,0.3);
    }
    .card-front::after {
      content: 'ğŸ­';
      font-size: clamp(1.2rem, 4vw, 1.8rem);
      opacity: 0.5;
    }
    .card-back {
      transform: rotateY(180deg);
      background: #fff;
      border: 2px solid #e9d5ff;
      padding: 5px;
    }
    .card-back .emoji {
      font-size: clamp(1.5rem, 5vw, 2.2rem);
      line-height: 1;
    }
    .card-back .label {
      font-size: clamp(0.6rem, 2vw, 0.8rem);
      color: #6b21a8;
      font-weight: 700;
      margin-top: 3px;
      text-align: center;
      line-height: 1.1;
    }
    .card.matched .card-back {
      border-color: #86efac;
      background: #f0fdf4;
    }
    .win-screen {
      position: fixed; top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(255,255,255,0.92);
      display: none; align-items: center; justify-content: center;
      flex-direction: column; z-index: 200; text-align: center; padding: 20px;
    }
    .win-screen.active { display: flex; }
    .win-emoji { font-size: 4rem; animation: bounce 1s ease-in-out infinite; }
    @keyframes bounce { 0%,100% { transform: translateY(0); } 50% { transform: translateY(-15px); } }
    .win-title {
      font-family: 'Frank Ruhl Libre', serif;
      font-size: 2.2rem; color: #7c3aed; margin: 12px 0;
    }
    .win-stats { font-size: 1.1rem; color: #6b7280; margin-bottom: 15px; line-height: 2; }
    .win-btn {
      font-family: 'Heebo', sans-serif;
      padding: 10px 28px; font-size: 1rem;
      border: 2px solid #7c3aed; background: #7c3aed;
      color: #fff; border-radius: 12px; cursor: pointer;
      margin: 4px; transition: all 0.3s;
    }
    .win-btn:hover { background: #6d28d9; }
    .win-btn.secondary { background: #fff; color: #7c3aed; }
  </style>
</head>
<body>

<a href="../index.html" class="back-link">â†’ ×—×–×¨×”</a>
<h1>ğŸ§© ×–×™×›×¨×•×Ÿ ×¤×•×¨×™×</h1>
<div class="difficulty-select">
  <button class="diff-btn active" onclick="startGame(4)">×§×œ</button>
  <button class="diff-btn" onclick="startGame(5)">×‘×™× ×•× ×™</button>
  <button class="diff-btn" onclick="startGame(6)">×§×©×”</button>
</div>
<div class="stats">
  <div class="stat">××”×œ×›×™×: <span id="moves">0</span></div>
  <div class="stat">×–×•×’×•×ª: <span id="pairs">0</span>/<span id="totalPairs">8</span></div>
  <div class="stat">â±ï¸ <span id="timer">0:00</span></div>
</div>
<div class="board size-4" id="board"></div>
<div class="win-screen" id="winScreen">
  <div class="win-emoji">ğŸ†</div>
  <h2 class="win-title">×›×œ ×”×›×‘×•×“!</h2>
  <div class="win-stats" id="winStats"></div>
  <button class="win-btn" onclick="startGame(currentSize)">×©×—×§×• ×©×•×‘!</button>
  <button class="win-btn secondary" onclick="location.href='../index.html'">×—×–×¨×”</button>
</div>

<script>
const CHARACTERS = [
  { emoji: 'ğŸ‘¸', name: '××¡×ª×¨' },
  { emoji: 'ğŸ§”', name: '××¨×“×›×™' },
  { emoji: 'ğŸ‘‘', name: '××—×©×•×¨×•×©' },
  { emoji: 'ğŸ˜ˆ', name: '×”××Ÿ' },
  { emoji: 'ğŸ‘°', name: '×•×©×ª×™' },
  { emoji: 'ğŸ—¡ï¸', name: '×—×¨×‘×•× ×' },
  { emoji: 'ğŸ“œ', name: '×”××’×™×œ×”' },
  { emoji: 'ğŸ´', name: '×¡×•×¡ ×”××œ×š' },
  { emoji: 'ğŸ‘¿', name: '×–×¨×©' },
  { emoji: 'ğŸ°', name: '×©×•×©×Ÿ ×”×‘×™×¨×”' },
  { emoji: 'ğŸ­', name: '×ª×—×¤×•×©×ª' },
  { emoji: 'ğŸª', name: '××•×–×Ÿ ×”××Ÿ' },
  { emoji: 'ğŸ“¢', name: '×¨×¢×©×Ÿ' },
  { emoji: 'ğŸ', name: '××©×œ×•×— ×× ×•×ª' },
  { emoji: 'ğŸ·', name: '××©×ª×” ×”×™×™×Ÿ' },
  { emoji: 'ğŸŒ³', name: '×¢×¥ ×”××Ÿ' },
];

let currentSize = 4, cards = [], flipped = [], matched = 0, moves = 0, timer = null, seconds = 0, locked = false;

function startGame(size) {
  currentSize = size;
  const pairsMap = { 4: 8, 5: 10, 6: 12 };
  const totalPairsCount = pairsMap[size];
  matched = 0; moves = 0; seconds = 0; flipped = []; locked = false;
  document.getElementById('moves').textContent = '0';
  document.getElementById('pairs').textContent = '0';
  document.getElementById('totalPairs').textContent = totalPairsCount;
  document.getElementById('timer').textContent = '0:00';
  document.getElementById('winScreen').classList.remove('active');
  document.querySelectorAll('.diff-btn').forEach((b, i) => b.classList.toggle('active', [4,5,6][i] === size));
  const board = document.getElementById('board');
  board.className = `board size-${size}`;
  const selected = CHARACTERS.slice(0, totalPairsCount);
  const deck = [...selected, ...selected];
  shuffle(deck);
  cards = deck;
  board.innerHTML = '';
  deck.forEach((char, i) => {
    const card = document.createElement('div');
    card.className = 'card';
    card.innerHTML = `
      <div class="card-inner">
        <div class="card-face card-front"></div>
        <div class="card-face card-back">
          <span class="emoji">${char.emoji}</span>
          <span class="label">${char.name}</span>
        </div>
      </div>`;
    card.addEventListener('click', () => flipCard(card, i));
    board.appendChild(card);
  });
  if (timer) clearInterval(timer);
  timer = setInterval(() => {
    seconds++;
    document.getElementById('timer').textContent = `${Math.floor(seconds/60)}:${(seconds%60).toString().padStart(2,'0')}`;
  }, 1000);
}

function flipCard(cardEl, index) {
  if (locked || cardEl.classList.contains('flipped') || cardEl.classList.contains('matched') || flipped.length >= 2) return;
  cardEl.classList.add('flipped');
  flipped.push({ el: cardEl, index });
  if (flipped.length === 2) {
    moves++;
    document.getElementById('moves').textContent = moves;
    locked = true;
    const [a, b] = flipped;
    if (cards[a.index].emoji === cards[b.index].emoji) {
      setTimeout(() => {
        a.el.classList.add('matched');
        b.el.classList.add('matched');
        matched++;
        document.getElementById('pairs').textContent = matched;
        flipped = []; locked = false;
        const totalPairsCount = { 4: 8, 5: 10, 6: 12 }[currentSize];
        if (matched === totalPairsCount) { clearInterval(timer); showWin(totalPairsCount); }
      }, 350);
    } else {
      setTimeout(() => {
        a.el.classList.remove('flipped');
        b.el.classList.remove('flipped');
        flipped = []; locked = false;
      }, 700);
    }
  }
}

function showWin(totalPairsCount) {
  const t = `${Math.floor(seconds/60)}:${(seconds%60).toString().padStart(2,'0')}`;
  let stars = moves <= totalPairsCount * 2 ? 'â­â­â­' : moves <= totalPairsCount * 3.5 ? 'â­â­' : 'â­';
  document.getElementById('winStats').innerHTML = `${stars}<br>â±ï¸ ${t}<br>ğŸ¯ ${moves} ××”×œ×›×™×`;
  document.getElementById('winScreen').classList.add('active');
}

function shuffle(a) { for (let i = a.length-1; i > 0; i--) { const j = Math.floor(Math.random()*(i+1)); [a[i],a[j]] = [a[j],a[i]]; } }
startGame(4);
</script>
</body>
</html>
